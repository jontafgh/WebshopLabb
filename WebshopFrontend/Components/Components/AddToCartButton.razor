@inject IJSRuntime Js
@inject ICounterService CartCounterService
@inject ICartService CartService

<button class="@GetButtonClasses()" @onclick="AddToCart">
    <span>@GetButtonText()</span>
</button>

@code {
    [Parameter] public required int ProductId { get; set; }
    [Parameter] public required int Stock { get; set; }

    private int _quantity = 1;

    private async Task AddToCart()
    {
        var cartItem = await CartService.AddItem(new CartItemToAddDto { ProductId = ProductId, Quantity = _quantity, CartId = GetCartId() });
        CartCounterService.AddToCount(_quantity);
    }

    private int GetCartId() => 1;

    private string GetButtonText() => Stock > 0 ? "Buy" : "Reserve";

    private string GetButtonClasses()
    {
        const string defaultClasses = "text-center text-xlarge text-bold button-block";
        var addedClass = Stock > 0 ? " button-buy" : " button-reserve";

        return defaultClasses + addedClass;
    }


}
